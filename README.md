# ç½‘ç»œæœç´¢å¼•æ“è¯„ä¼°ç³»ç»Ÿ

ä¸€ä¸ªç”¨äºè¯„ä¼°å’Œæ¯”è¾ƒä¸åŒæœç´¢å¼•æ“æ€§èƒ½çš„å·¥å…·ã€‚

## âœ¨ ç‰¹æ€§

- ğŸ” æ”¯æŒå¤šä¸ªæœç´¢å¼•æ“ï¼ˆJina AIã€Serperã€æ™ºè°±AIï¼‰
- ğŸ¤– AIé©±åŠ¨çš„æ™ºèƒ½è¯„ä¼°ç³»ç»Ÿ
- ğŸ“Š å¤šç»´åº¦è¯„ä¼°ï¼ˆæƒå¨æ€§ã€ç›¸å…³æ€§ã€æ—¶æ•ˆæ€§ï¼‰
- ğŸ“ˆ è¯¦ç»†çš„æ€§èƒ½æŠ¥å‘Šå’Œå¯è§†åŒ–
- ğŸš€ æ‰¹é‡æµ‹è¯•å’Œå•æ¬¡æŸ¥è¯¢æ”¯æŒ
- ğŸ“ å¤šç§æ•°æ®æ ¼å¼æ”¯æŒï¼ˆJSONã€CSVã€TXTï¼‰

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–
```bash
pnpm install
```

### åˆå§‹åŒ–é…ç½®
```bash
pnpm run init
```

### åˆ›å»ºç¤ºä¾‹æ–‡ä»¶
```bash
pnpm run samples
```

### é…ç½®APIå¯†é’¥
ç¼–è¾‘ `config.json` æ–‡ä»¶ï¼Œæ›¿æ¢ä»¥ä¸‹å ä½ç¬¦ï¼š
- `YOUR_JINA_API_KEY` - Jina AIæœç´¢APIå¯†é’¥
- `YOUR_SERPER_API_KEY` - Serper Googleæœç´¢APIå¯†é’¥  
- `YOUR_ZHIPU_API_KEY` - æ™ºè°±AIæœç´¢APIå¯†é’¥
- `YOUR_MODEL_API_KEY` - AIè¯„ä¼°æ¨¡å‹APIå¯†é’¥

## ğŸ“‹ ä½¿ç”¨æ–¹æ³•

### æŸ¥çœ‹å¸®åŠ©
```bash
pnpm run help
```

### æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€
```bash
pnpm run status
```

### æµ‹è¯•æœç´¢å¼•æ“è¿æ¥
```bash
pnpm run test -- --test-connection
```

### å•æ¬¡æŸ¥è¯¢è¯„ä¼°
```bash
pnpm run eval -- "JavaScriptå¼‚æ­¥ç¼–ç¨‹æœ€ä½³å®è·µ"
```

### æ‰¹é‡æµ‹è¯•
```bash
pnpm run batch -- ./samples/sample_queries.json
```

## ğŸ“Š è¾“å‡ºç»“æœ

ç³»ç»Ÿä¼šç”Ÿæˆä»¥ä¸‹ç±»å‹çš„æŠ¥å‘Šï¼š
- è¯¦ç»†ç»“æœï¼ˆJSONæ ¼å¼ï¼‰
- æ±‡æ€»æŠ¥å‘Šï¼ˆåŒ…å«ç»Ÿè®¡åˆ†æï¼‰
- CSVæŠ¥å‘Šï¼ˆé€‚åˆExcelåˆ†æï¼‰

## ğŸ“– è¯¦ç»†æ–‡æ¡£

æŸ¥çœ‹ [USAGE.md](./USAGE.md) è·å–è¯¦ç»†çš„ä½¿ç”¨è¯´æ˜å’Œé…ç½®æŒ‡å—ã€‚

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- Node.js + ES6 æ¨¡å—
- Commander.jsï¼ˆå‘½ä»¤è¡Œç•Œé¢ï¼‰
- å¤šä¸ªæœç´¢å¼•æ“APIé›†æˆ
- AIæ¨¡å‹è¯„ä¼°ï¼ˆæ”¯æŒOpenAIç­‰ï¼‰

## ğŸ“ é¡¹ç›®ç»“æ„

```
src/
â”œâ”€â”€ batch/          # æ‰¹é‡æµ‹è¯•ç®¡ç†
â”œâ”€â”€ config/         # é…ç½®ç®¡ç†
â”œâ”€â”€ data/           # æ•°æ®å¤„ç†
â”œâ”€â”€ evaluation/     # è¯„ä¼°ç³»ç»Ÿ
â”œâ”€â”€ report/         # æŠ¥å‘Šç”Ÿæˆ
â””â”€â”€ search/         # æœç´¢å¼•æ“å®ç°
```

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤Issueå’ŒPull Requestæ¥æ”¹è¿›è¿™ä¸ªé¡¹ç›®ï¼

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸš€ åŠŸèƒ½ç‰¹æ€§

- **å¤šæœç´¢å¼•æ“æ”¯æŒ**: æ”¯æŒ Jinaã€Serperã€æ™ºè°±ç­‰æœç´¢å¼•æ“API
- **å¤šç»´åº¦è¯„ä¼°**: å¯è‡ªå®šä¹‰è¯„ä¼°ç»´åº¦ï¼ˆé»˜è®¤ï¼šæƒå¨æ€§ã€ç›¸å…³æ€§ã€æ—¶æ•ˆæ€§ï¼‰
- **å¤šç§è¯„åˆ†ä½“ç³»**: æ”¯æŒäºŒåˆ†åˆ¶ï¼ˆ0-2åˆ†ï¼‰å’Œäº”åˆ†åˆ¶ï¼ˆ1-5åˆ†ï¼‰è¯„åˆ†
- **æ‰¹é‡æµ‹è¯•**: æ”¯æŒæ‰¹é‡å¯¼å…¥æŸ¥è¯¢è¿›è¡Œè¯„ä¼°
- **æ™ºèƒ½æŠ¥å‘Š**: è‡ªåŠ¨ç”ŸæˆHTMLã€Markdownã€JSONæ ¼å¼çš„è¯„ä¼°æŠ¥å‘Š
- **å‘½ä»¤è¡Œå·¥å…·**: æä¾›ä¾¿æ·çš„CLIå·¥å…·
- **å¯é…ç½®æƒé‡**: æ”¯æŒè‡ªå®šä¹‰å„ç»´åº¦æƒé‡åˆ†é…

## ğŸ“¦ å®‰è£…

### ç¯å¢ƒè¦æ±‚

- Node.js >= 18.0.0
- pnpmï¼ˆæ¨èï¼‰æˆ– npm

### å®‰è£…ä¾èµ–

```bash
# ä½¿ç”¨ pnpmï¼ˆæ¨èï¼‰
pnpm install

# æˆ–ä½¿ç”¨ npm
npm install
```

## âš™ï¸ é…ç½®

### 1. åˆå§‹åŒ–é…ç½®

```bash
# åˆ›å»ºé…ç½®æ–‡ä»¶å’Œç›®å½•ç»“æ„
pnpm run init

# æˆ–ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·
npx web-search-eval init
```

### 2. é…ç½®APIå¯†é’¥

å¤åˆ¶ç¤ºä¾‹é…ç½®æ–‡ä»¶å¹¶ç¼–è¾‘ï¼š

```bash
cp config.example.json config.json
```

ç¼–è¾‘ `config.json` æ–‡ä»¶ï¼Œå¡«å…¥æ‚¨çš„APIå¯†é’¥ï¼š

```json
{
  "model": {
    "api_key": "your_model_api_key_here",
    "base_url": "https://open.bigmodel.cn/api/paas/v4/chat/completions",
    "model_name": "glm-4"
  },
  "search_engines": {
    "jina": {
      "enabled": true,
      "api_key": "your_jina_api_key_here"
    },
    "serper": {
      "enabled": true,
      "api_key": "your_serper_api_key_here"
    },
    "zhipu": {
      "enabled": true,
      "api_key": "your_zhipu_api_key_here"
    }
  }
}
```

### 3. æµ‹è¯•è¿æ¥

```bash
# æµ‹è¯•æ‰€æœ‰æœç´¢å¼•æ“è¿æ¥
pnpm run test

# æˆ–
npx web-search-eval test
```

## ğŸ¯ ä½¿ç”¨æ–¹æ³•

### å‘½ä»¤è¡Œå·¥å…·

#### 1. å•ä¸ªæŸ¥è¯¢è¯„ä¼°

```bash
# è¯„ä¼°å•ä¸ªæŸ¥è¯¢
npx web-search-eval eval "äººå·¥æ™ºèƒ½å‘å±•è¶‹åŠ¿"

# æŒ‡å®šè¾“å‡ºç›®å½•
npx web-search-eval eval "äººå·¥æ™ºèƒ½å‘å±•è¶‹åŠ¿" -o ./my-results
```

#### 2. æ‰¹é‡è¯„ä¼°

```bash
# ä½¿ç”¨æŸ¥è¯¢æ–‡ä»¶
npx web-search-eval batch ./samples/sample_queries.json

# ä½¿ç”¨é€—å·åˆ†éš”çš„æŸ¥è¯¢åˆ—è¡¨
npx web-search-eval batch "æŸ¥è¯¢1,æŸ¥è¯¢2,æŸ¥è¯¢3"

# æŒ‡å®šé‡å¤æ¬¡æ•°å’Œè¾“å‡ºæ ¼å¼
npx web-search-eval batch queries.json -r 5 --format html,markdown,json
```

#### 3. åˆ›å»ºç¤ºä¾‹æ–‡ä»¶

```bash
# åˆ›å»ºç¤ºä¾‹æŸ¥è¯¢æ–‡ä»¶
npx web-search-eval samples

# æŒ‡å®šè¾“å‡ºç›®å½•
npx web-search-eval samples -o ./my-samples
```

#### 4. æŸ¥çœ‹ç³»ç»ŸçŠ¶æ€

```bash
npx web-search-eval status
```

### ç¼–ç¨‹æ¥å£

```javascript
import { createEvaluationSystem } from './src/index.js';

// åˆ›å»ºå¹¶åˆå§‹åŒ–ç³»ç»Ÿ
const system = await createEvaluationSystem('./config.json');

// è¯„ä¼°å•ä¸ªæŸ¥è¯¢
const result = await system.evaluateSingleQuery('äººå·¥æ™ºèƒ½å‘å±•è¶‹åŠ¿');
console.log(result);

// æ‰¹é‡è¯„ä¼°
const batchResult = await system.runBatchEvaluation([
  'äººå·¥æ™ºèƒ½å‘å±•è¶‹åŠ¿',
  'åŒºå—é“¾æŠ€æœ¯åº”ç”¨',
  'é‡å­è®¡ç®—å‰æ™¯'
], {
  repeatTimes: 3,
  outputDir: './results'
});

// æµ‹è¯•è¿æ¥
const connectionResults = await system.testConnections();
console.log(connectionResults);
```

## ğŸ“Š è¯„ä¼°ç»´åº¦

### é»˜è®¤ç»´åº¦

1. **æƒå¨æ€§** (æƒé‡: 0.4)
   - è¯„ä¼°ä¿¡æ¯æ¥æºçš„æƒå¨æ€§å’Œå¯ä¿¡åº¦
   - è€ƒè™‘ç½‘ç«™å£°èª‰ã€ä½œè€…ä¸“ä¸šæ€§ç­‰å› ç´ 

2. **ç›¸å…³æ€§** (æƒé‡: 0.35)
   - è¯„ä¼°æœç´¢ç»“æœä¸æŸ¥è¯¢çš„ç›¸å…³ç¨‹åº¦
   - è€ƒè™‘å†…å®¹åŒ¹é…åº¦ã€ä¸»é¢˜ä¸€è‡´æ€§ç­‰

3. **æ—¶æ•ˆæ€§** (æƒé‡: 0.25)
   - è¯„ä¼°ä¿¡æ¯çš„æ—¶æ•ˆæ€§å’Œæœ€æ–°ç¨‹åº¦
   - è€ƒè™‘å‘å¸ƒæ—¶é—´ã€æ›´æ–°é¢‘ç‡ç­‰

### è‡ªå®šä¹‰ç»´åº¦

æ‚¨å¯ä»¥åœ¨é…ç½®æ–‡ä»¶ä¸­è‡ªå®šä¹‰è¯„ä¼°ç»´åº¦ï¼š

```json
{
  "evaluation": {
    "dimensions": [
      {
        "name": "è‡ªå®šä¹‰ç»´åº¦1",
        "weight": 0.5,
        "description": "ç»´åº¦æè¿°"
      },
      {
        "name": "è‡ªå®šä¹‰ç»´åº¦2",
        "weight": 0.3,
        "description": "ç»´åº¦æè¿°"
      },
      {
        "name": "è‡ªå®šä¹‰ç»´åº¦3",
        "weight": 0.2,
        "description": "ç»´åº¦æè¿°"
      }
    ]
  }
}
```

## ğŸ¨ è¯„åˆ†ä½“ç³»

### äºŒåˆ†åˆ¶è¯„åˆ† (0-2åˆ†)

- **0åˆ†**: ä¸æ»¡è¶³è¦æ±‚
- **1åˆ†**: éƒ¨åˆ†æ»¡è¶³è¦æ±‚
- **2åˆ†**: å®Œå…¨æ»¡è¶³è¦æ±‚

### äº”åˆ†åˆ¶è¯„åˆ† (1-5åˆ†)

- **1åˆ†**: å¾ˆå·®
- **2åˆ†**: è¾ƒå·®
- **3åˆ†**: ä¸€èˆ¬
- **4åˆ†**: è¾ƒå¥½
- **5åˆ†**: å¾ˆå¥½

### è‡ªå®šä¹‰æç¤ºè¯

æ‚¨å¯ä»¥ä¸ºæ¯ä¸ªç»´åº¦å’Œè¯„åˆ†ä½“ç³»è‡ªå®šä¹‰è¯„åˆ†æç¤ºè¯ï¼š

```json
{
  "evaluation": {
    "scoring_systems": {
      "five_point": {
        "prompts": {
          "æƒå¨æ€§": "æ‚¨çš„è‡ªå®šä¹‰æƒå¨æ€§è¯„åˆ†æç¤ºè¯...",
          "ç›¸å…³æ€§": "æ‚¨çš„è‡ªå®šä¹‰ç›¸å…³æ€§è¯„åˆ†æç¤ºè¯...",
          "æ—¶æ•ˆæ€§": "æ‚¨çš„è‡ªå®šä¹‰æ—¶æ•ˆæ€§è¯„åˆ†æç¤ºè¯..."
        }
      }
    }
  }
}
```

## ğŸ“ æ–‡ä»¶æ ¼å¼

### æŸ¥è¯¢æ–‡ä»¶æ ¼å¼

#### JSONæ ¼å¼
```json
[
  "æŸ¥è¯¢1",
  "æŸ¥è¯¢2",
  "æŸ¥è¯¢3"
]
```

#### CSVæ ¼å¼
```csv
query
æŸ¥è¯¢1
æŸ¥è¯¢2
æŸ¥è¯¢3
```

#### TXTæ ¼å¼
```
æŸ¥è¯¢1
æŸ¥è¯¢2
æŸ¥è¯¢3
```

### ç»“æœæ–‡ä»¶æ ¼å¼

ç³»ç»Ÿä¼šç”Ÿæˆä»¥ä¸‹æ ¼å¼çš„ç»“æœæ–‡ä»¶ï¼š

- **JSON**: å®Œæ•´çš„ç»“æ„åŒ–æ•°æ®
- **CSV**: æ‰å¹³åŒ–çš„è¡¨æ ¼æ•°æ®
- **HTML**: å¯è§†åŒ–çš„ç½‘é¡µæŠ¥å‘Š
- **Markdown**: æ–‡æ¡£æ ¼å¼çš„æŠ¥å‘Š

## ğŸ”§ é«˜çº§é…ç½®

### æœç´¢å¼•æ“é…ç½®

```json
{
  "search_engines": {
    "jina": {
      "enabled": true,
      "api_key": "your_key",
      "max_results": 10,
      "timeout": 15000
    }
  }
}
```

### è¯„ä¼°é…ç½®

```json
{
  "evaluation": {
    "repeat_times": 3,
    "delay_between_requests": 1000,
    "default_scoring_system": "five_point"
  }
}
```

### è¾“å‡ºé…ç½®

```json
{
  "output": {
    "default_format": ["html", "markdown", "json"],
    "include_raw_results": true,
    "include_detailed_scores": true
  }
}
```

## ğŸ“ˆ æŠ¥å‘Šç¤ºä¾‹

è¯„ä¼°å®Œæˆåï¼Œç³»ç»Ÿä¼šç”ŸæˆåŒ…å«ä»¥ä¸‹å†…å®¹çš„æŠ¥å‘Šï¼š

- **æœç´¢å¼•æ“æ’å**: æŒ‰å¹³å‡å¾—åˆ†æ’åº
- **è¯¦ç»†è¯„åˆ†**: æ¯ä¸ªç»´åº¦çš„å…·ä½“å¾—åˆ†
- **ç»Ÿè®¡åˆ†æ**: å¹³å‡åˆ†ã€æ ‡å‡†å·®ç­‰ç»Ÿè®¡ä¿¡æ¯
- **ç¨³å®šæ€§åˆ†æ**: å¤šæ¬¡æµ‹è¯•çš„ä¸€è‡´æ€§åˆ†æ

## ğŸ› ï¸ å¼€å‘

### é¡¹ç›®ç»“æ„

```
web-search-eval/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ config/          # é…ç½®ç®¡ç†
â”‚   â”œâ”€â”€ search/          # æœç´¢å¼•æ“æ¥å£
â”‚   â”œâ”€â”€ evaluation/      # è¯„ä¼°ç³»ç»Ÿ
â”‚   â”œâ”€â”€ batch/           # æ‰¹é‡æµ‹è¯•
â”‚   â”œâ”€â”€ report/          # æŠ¥å‘Šç”Ÿæˆ
â”‚   â”œâ”€â”€ data/            # æ•°æ®å¤„ç†
â”‚   â”œâ”€â”€ index.js         # ä¸»å…¥å£
â”‚   â””â”€â”€ cli.js           # å‘½ä»¤è¡Œå·¥å…·
â”œâ”€â”€ config.example.json  # ç¤ºä¾‹é…ç½®
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

### å¼€å‘æ¨¡å¼

```bash
# å¯åŠ¨å¼€å‘æ¨¡å¼ï¼ˆæ–‡ä»¶ç›‘å¬ï¼‰
pnpm run dev
```

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ†˜ å¸¸è§é—®é¢˜

### Q: å¦‚ä½•æ·»åŠ æ–°çš„æœç´¢å¼•æ“ï¼Ÿ

A: ç»§æ‰¿ `SearchEngine` åŸºç±»å¹¶å®ç°ç›¸åº”çš„æ–¹æ³•ï¼Œç„¶ååœ¨é…ç½®æ–‡ä»¶ä¸­æ·»åŠ ç›¸åº”é…ç½®ã€‚

### Q: å¦‚ä½•è‡ªå®šä¹‰è¯„åˆ†ç»´åº¦ï¼Ÿ

A: åœ¨é…ç½®æ–‡ä»¶çš„ `evaluation.dimensions` ä¸­æ·»åŠ æ–°çš„ç»´åº¦é…ç½®ã€‚

### Q: è¯„ä¼°é€Ÿåº¦è¾ƒæ…¢æ€ä¹ˆåŠï¼Ÿ

A: å¯ä»¥è°ƒæ•´ `repeat_times` å’Œ `delay_between_requests` å‚æ•°æ¥å¹³è¡¡é€Ÿåº¦å’Œå‡†ç¡®æ€§ã€‚

### Q: APIè°ƒç”¨å¤±è´¥æ€ä¹ˆåŠï¼Ÿ

A: æ£€æŸ¥APIå¯†é’¥æ˜¯å¦æ­£ç¡®ï¼Œç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸ï¼Œå¯ä»¥ä½¿ç”¨ `test` å‘½ä»¤è¿›è¡Œè¿æ¥æµ‹è¯•ã€‚

---

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹æ–‡æ¡£æˆ–æäº¤ Issueã€‚